@using PhishingGame.Data
@using Radzen.Blazor
@using Core
@using Core.Models

@inject IServiceProvider _serviceProvider
@inject ISessionManager _sessionManager
@inject NavigationManager _navigator
@inject PhishingDbContext _dbContext
@page "/host"
@page "/"



@if (Session == null)
{
    <RadzenButton Click="@OnClick">Start nieuwe sessie</RadzenButton>
}

@code {
    public Session? Session { get; set; }
    public ILinkedState? CurrentState => Session?.CurrentState;

    public void OnClick()
    {
        var training = _dbContext.Trainings.First(training => training.Id == Guid.Parse("ef262231-1f12-41ff-f137-08de311c2c85"));
        Session = _sessionManager.CreateSession(training, _serviceProvider);
        Session.Initialize();
        _navigator.NavigateTo($"session/{Session.SessionId}", true);
    }
}
