@using PhishingGame.Blazor.States
@using PhishingGame.Core
@using Radzen
@using Radzen.Blazor
@inherits GameViewBase<HighscoreState>

<RadzenCard Style="padding:16px;">
    <h3>Highscores — Player view</h3>

    @if (State?.RankedTeams == null || !State.RankedTeams.Any())
    {
        <p>No teams available.</p>
    }
    else
    {
        <RadzenDataGrid Data="@State.RankedTeams" TItem="Team" AllowPaging="false" RowHover="true">
            <Columns>
                <RadzenDataGridColumn TItem="Team" Title="#" Context="team">
                    <Template Context="team">
                        @(State.RankedTeams.IndexOf(team) + 1)
                    </Template>
                </RadzenDataGridColumn>
                <RadzenDataGridColumn TItem="Team" Property="Name" Title="Team" />
                <RadzenDataGridColumn TItem="Team" Property="Score" Title="Score" />
            </Columns>
        </RadzenDataGrid>
    }
</RadzenCard>

@code {
    [CascadingParameter] public Session Session { get; set; }

    protected override void OnParametersSet()
    {
        State?.RecalculateRanking();
        InvokeAsync(StateHasChanged);
    }
}